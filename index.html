<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IF25 Terkece Biodata</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Berkshire+Swash&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --text-color: #333;
            --card-bg: rgba(230, 230, 254, 0.95);
            --nim-bg: #ecf0f1;
            --nim-text: #2c3e50;
            --fixed-bg: rgba(255, 255, 255, 0.85);
            --fixed-text: #2c3e50;
            --firefly-color: #ffeb3b; 
            --glow-color: rgba(52, 152, 219, 0.3); 
        }

        body.dark-mode {
            --bg-gradient: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            --text-color: #e0e0e0;
            --card-bg: rgba(43, 63, 118, 0.96); 
            --nim-bg: #1a1a2e;
            --nim-text: #bdc3c7;
            --fixed-bg: rgba(15, 52, 96, 0.85);
            --fixed-text: #e0e0e0;
            --firefly-color: #76ff03;
            --glow-color: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Poppins', sans-serif; 
            background: var(--bg-gradient); 
            min-height: 100vh; 
            overflow-x: hidden; 
            position: relative;
            -webkit-overflow-scrolling: touch; 
        }

        /* --- BACKGROUND LAYERS --- */
        #fireflies-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0; overflow: hidden;
            transform: translateZ(0); 
        }
        
        .firefly {
            position: absolute; border-radius: 50%;
            background-color: var(--firefly-color);
            box-shadow: 0 0 6px var(--firefly-color);
            opacity: 0;
            will-change: transform, opacity; 
        }

        @keyframes drift {
            0% { transform: translate(0, 0) scale(0.8); opacity: 0; }
            20% { opacity: 0.8; transform: translate(20px, -20px) scale(1.1); }
            80% { opacity: 0.2; transform: translate(80px, -80px) scale(0.8); }
            100% { opacity: 0; transform: translate(100px, -100px) scale(0.5); }
        }

        /* --- FIXED ELEMENTS --- */
        .fixed-element {
            position: fixed; top: 20px; z-index: 1000;
            background: var(--fixed-bg); padding: 10px 20px;
            border-radius: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: var(--fixed-text);
            display: flex; align-items: center; justify-content: center;
            text-decoration: none; font-size: 14px; font-weight: 600;
            transition: transform 0.2s; border: 1px solid rgba(255,255,255,0.1);
        }
        .pos-left { left: 20px; }
        .pos-right { right: 20px; }
        .pos-theme { right: 180px; width: 45px; height: 45px; padding: 0; cursor: pointer; border: none; font-size: 18px; }
        .pos-right i { color: #ff0000; font-size: 18px; margin-right: 8px; }
        .pos-theme i { color: #f1c40f; }
        body.dark-mode .pos-theme i { color: #f39c12; }

        /* --- NOW PLAYING BOX --- */
        .now-playing-box {
            position: fixed; bottom: 20px; right: -350px;
            z-index: 9999;
            background: var(--fixed-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex; align-items: center; gap: 15px;
            transition: right 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 300px;
        }
        .now-playing-box.show { right: 20px; }
        .np-icon {
            width: 35px; height: 35px; background: #e91e63; color: white;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 14px; animation: spin 3s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .np-info { display: flex; flex-direction: column; overflow: hidden; }
        .np-label { font-size: 10px; color: var(--text-color); opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; }
        .np-title { font-size: 13px; font-weight: 700; color: var(--fixed-text); white-space: nowrap; }
        .np-mute {
            background: transparent; border: none; color: var(--fixed-text);
            cursor: pointer; font-size: 16px; transition: 0.3s;
        }
        .np-mute:hover { color: #e91e63; }

        /* --- MOBILE LAYOUT --- */
        .mobile-layout-controls {
            display: none; position: fixed; top: 75px; left: 50%; transform: translateX(-50%);
            z-index: 990; background: var(--fixed-bg); padding: 4px; border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .mobile-btn {
            background: transparent; border: none; color: var(--fixed-text);
            padding: 6px 15px; border-radius: 20px; cursor: pointer;
            font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 5px; transition: 0.3s;
        }
        .mobile-btn.active { background: #3498db; color: white; box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3); }

        /* --- UTAMA --- */
        #main-view { position: relative; z-index: 10; transition: opacity 0.5s; min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px 40px 20px; padding-top: 100px; }
        header { text-align: center; margin-bottom: 30px; }
        
        h1 { 
            font-family: 'Berkshire Swash', cursive;
            font-weight: 400; color: #ff0000; margin-bottom: 5px; 
            font-size: 3rem; letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        p.subtitle { color: #ddd; margin-bottom: 25px; }
        
        .search-box { width: 100%; max-width: 500px; margin: 0 auto 30px auto; }
        .search-box input {
            width: 100%; padding: 15px 25px; border-radius: 50px; border: none;
            font-family: 'Poppins', sans-serif; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            background: var(--card-bg); color: var(--text-color);
        }
        
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        
        /* --- CARD STYLING --- */
        .card {
            background: var(--card-bg); 
            border-radius: 15px; padding: 25px; text-align: center; 
            border-top: 5px solid transparent; cursor: pointer;
            position: relative; overflow: hidden;
            
            backdrop-filter: none !important; 
            -webkit-backdrop-filter: none !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
            contain: content; 
            content-visibility: auto; 
            will-change: transform;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card::after {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(600px circle at var(--x) var(--y), var(--glow-color), transparent 40%);
            opacity: 0; 
            transition: opacity 0.3s ease;
            pointer-events: none; 
            z-index: 2; 
        }

        .card:hover::after { opacity: 1; }
        .card:hover { transform: translateY(-5px); border-top: 5px solid #3498db; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .card.hidden-card { display: none; } 

        /* --- Animasi Khusus Kartu Owner --- */
        @keyframes ownerGlowLoop {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .card.owner-card {
            background: linear-gradient(
                45deg, 
                #059669, #10b981, 
                #de7ed4cc, #e598ffcc, 
                #10b981, #059669
            );
            background-size: 400% 400%;
            animation: ownerGlowLoop 8s ease infinite; 
            color: white !important; 
            border: 2px solid #ffd700;
            text-shadow: 0 1px 4px rgba(0,0,0,0.6); 
        }

        .card.owner-card .avatar, 
        .card.owner-card h3, 
        .card.owner-card .nim-badge {
            position: relative;
            z-index: 5;
        }

        .card.owner-card .owner-badge,
        .card.owner-card .gender-tag {
            z-index: 10;
        }

        /* --- STYLING CARD KHUSUS --- */
        
        /* 1. Ketua */
        .card.ketua-card {
            background: linear-gradient(135deg, #2980b9 0%, #6dd5fa 100%);
            color: white !important; border: 2px solid #fff;
        }

        /* 2. Wakil 1 (Ungu Gradasi Pink) */
        .card.wakil1-card, .big-profile-card.wakil1-profile {
            background: linear-gradient(135deg, #6F2DA8 0%, #C54B8C 100%);
            color: white !important; border: 2px solid #ff758c;
        }
        .wakil1-badge { background: #fff; color: #8e44ad; }

        /* 3. Wakil 2 (Oren Gradasi Merah Tipis) */
        .card.wakil2-card, .big-profile-card.wakil2-profile {
            background: linear-gradient(135deg, #f39c12 0%, #e74c3c 100%);
            color: white !important; border: 2px solid #f39c12;
        }
        .wakil2-badge { background: #fff; color: #e67e22; }

        /* 4. Keamanan (Hitam Gradasi Merah) */
        .card.keamanan-card, .big-profile-card.keamanan-profile {
            background: linear-gradient(135deg, #FF2400 0%, #7C0A02 150%);
            color: white !important; border: 2px solid #ff0000;
        }
        .keamanan-badge { background: #000; color: #ff0000; border: 1px solid #ff0000; }

        /* 5. PJ Matkul Leni (Soft Pink Gradasi Putih Tipis) */
        .card.pj-leni-card, .big-profile-card.pj-leni-profile {
            background: linear-gradient(135deg, #FC6C85 0%, #FF46A2 100%);
            color: #444 !important; /* Text gelap agar terbaca */
            border: 2px solid #E89EB8;
        }
        .card.pj-leni-card h3, .card.pj-leni-card .nim-badge, .big-profile-card.pj-leni-profile .info-label, .big-profile-card.pj-leni-profile .info-val {
            color: #444 !important;
        }
        .card.pj-leni-card .nim-badge { background: rgba(255,255,255,0.25); }
        .pj-leni-badge { background: #ff6f91; color: white; }

        /* 6. PJ Matkul Nirwanda (Merah Muda Gradasi Merah Tua) */
        .card.pj-nirwanda-card, .big-profile-card.pj-nirwanda-profile {
            background: linear-gradient(135deg, #D30000 0%, #FF2400 80%);
            color: white !important; border: 2px solid #ff758c;
        }
        .pj-nirwanda-badge { background: #fff; color: #800020; }
        
        .card.owner-card h3, .card.ketua-card h3 { color: white !important; }
        .card.ketua-card h3 { text-shadow: 0 1px 2px rgba(0,0,0,0.2); }

        .card.owner-card .nim-badge, .card.ketua-card .nim-badge { 
            color: white; 
            background: rgba(255,255,255,0.25); 
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* --- BADGES (Absolute Positioning) --- */
        .owner-badge, .ketua-badge, .wakil-badge, .wakil1-badge, .wakil2-badge, .keamanan-badge, .pj-badge {
            position: absolute; top: 10px; left: 10px;
            font-size: 10px; padding: 2px 8px; border-radius: 8px; font-weight: 800;
            box-shadow: 0 2px 3px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 4px; z-index: 10;
        }
        .owner-badge { background: #ffd700; color: #b45309; text-shadow: none; }
        .ketua-badge { background: #fff; color: #2980b9; }

        .gender-tag {
            position: absolute; top: 10px; right: 10px; font-size: 12px;
            padding: 2px 8px; border-radius: 10px; color: white; font-weight: bold; z-index: 10;
        }
        .gender-L { background: #3498db; }
        .gender-P { background: #e91e63; }
        
        /* --- KONTEN DALAM KARTU --- */
        .avatar {
            width: 65px; height: 65px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 22px; font-weight: bold; margin: 0 auto 10px auto;
            position: relative; z-index: 5;
            -webkit-mask-image: -webkit-radial-gradient(white, black);
        }
        
        .card h3 { 
            font-size: 17px; font-weight: 600; color: var(--text-color); 
            min-height: 50px; display: flex; align-items: center; justify-content: center; 
            position: relative; z-index: 5;
        }
        .nim-badge { 
            background: var(--nim-bg); color: var(--nim-text); padding: 4px 12px; 
            border-radius: 15px; font-size: 13px; font-weight: 500; 
            position: relative; z-index: 5; 
        }

        /* --- PROFIL VIEW --- */
        #profile-view {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2000; display: none; opacity: 0;
            transition: opacity 0.3s ease; overflow-y: auto; background: rgba(0,0,0,0.9);
            will-change: opacity;
        }
        .galaxy-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none; }
        
        .stars {
            width: 1px; height: 1px; background: transparent;
            animation: animStar 60s linear infinite;
        }
        @keyframes animStar { from { transform: translateY(0px); } to { transform: translateY(-1000px); } }

        .profile-content {
            position: relative; width: 100%; min-height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px;
        }
        .back-btn-float {
            position: fixed; top: 20px; left: 20px; z-index: 2001;
            background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);
            color: white; padding: 10px 20px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer; font-weight: 600; transition: 0.2s;
        }
        
        .big-profile-card {
            background: rgba(30, 30, 30, 0.8);
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 40px; border-radius: 30px; text-align: center; color: white;
            width: 100%; max-width: 500px; box-shadow: 0 25px 50px rgba(0,0,0,0.5); 
            position: relative; overflow: hidden;
            animation: zoomIn 0.3s ease;
        }

        .big-profile-card.owner-profile {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.9) 0%, rgba(5, 150, 105, 0.9) 100%);
            border: 2px solid #ffd700;
        }
        .big-profile-card.ketua-profile {
            background: linear-gradient(135deg, rgba(41, 128, 185, 0.9) 0%, rgba(109, 213, 250, 0.9) 100%);
            border: 2px solid #fff;
        }

        .owner-role {
            font-size: 12px; background: #ffd700; color: #b45309; padding: 2px 10px;
            border-radius: 10px; display: inline-block; font-weight: 800; margin-bottom: 10px;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .owner-role.ketua-role-tag { background: #fff; color: #2980b9; }

        .big-avatar {
            width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 20px auto;
            background: linear-gradient(45deg, #ff00cc, #333399); display: flex; align-items: center; justify-content: center;
            font-size: 40px; font-weight: bold; border: 4px solid rgba(255,255,255,0.5); box-shadow: 0 0 30px rgba(255, 0, 204, 0.4);
        }
        .copy-btn {
            background: transparent; border: none; color: #bbb; cursor: pointer; margin-left: 8px; font-size: 14px; transition: 0.3s;
        }
        .copy-btn:hover { color: #fff; transform: scale(1.1); }
        .copy-tooltip { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 20px; z-index: 5000; opacity: 0; pointer-events: none; transition: 0.3s; }
        .copy-tooltip.show { opacity: 1; margin-top: -50px; }
        
        .info-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 14px; }
        .info-row:last-child { border-bottom: none; }
        .info-label { color: #aaa; text-align: left; }
        .big-profile-card.owner-profile .info-label, .big-profile-card.ketua-profile .info-label { color: #e0f2fe; } 
        .info-val { font-weight: 600; text-align: right; display: flex; align-items: center; gap: 8px; justify-content: flex-end;}
        
        .jodoh-btn {
            margin-top: 30px; width: 100%; padding: 15px; background: linear-gradient(90deg, #ff512f, #dd2476);
            border: none; border-radius: 50px; color: white; font-size: 16px; font-weight: bold; cursor: pointer;
            box-shadow: 0 10px 20px rgba(221, 36, 118, 0.4); transition: transform 0.2s; position: relative; overflow: hidden;
        }
        .quote-box {
            margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 15px;
            font-size: 13px; font-style: italic; color: #ddd; border-left: 4px solid #f1c40f; text-align: center;
        }

        /* --- FITUR IPK --- */
        .ipk-btn {
            margin-top: 15px; width: 100%; padding: 12px; 
            background: linear-gradient(135deg, #00b09b, #96c93d);
            border: none; border-radius: 50px; color: white; 
            font-size: 15px; font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 176, 155, 0.4); 
            transition: transform 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .ipk-btn:hover { transform: scale(1.02); }

        /* Modal IPK */
        .ipk-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 4000;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: 0.3s; backdrop-filter: blur(5px);
        }
        .ipk-modal.active { opacity: 1; visibility: visible; }
        
        .ipk-content {
            background: var(--card-bg); width: 90%; max-width: 400px;
            border-radius: 20px; padding: 30px; position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.2);
            transform: translateY(20px); transition: 0.3s;
        }
        .ipk-modal.active .ipk-content { transform: translateY(0); }

        .ipk-header { text-align: center; margin-bottom: 20px; color: var(--text-color); }
        .ipk-header h2 { font-size: 24px; margin-bottom: 5px; }
        .ipk-header p { font-size: 14px; opacity: 0.7; }

        .semester-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 25px; }
        .semester-row {
            display: flex; justify-content: space-between; padding: 12px 15px;
            background: rgba(0,0,0,0.05); border-radius: 10px;
            font-size: 14px; font-weight: 500; color: var(--text-color);
            border-left: 4px solid #ccc;
        }
        .semester-row.has-score { border-left: 4px solid #00b09b; background: rgba(0, 176, 155, 0.1); }

        .close-ipk {
            width: 100%; padding: 12px; background: #333; color: white; border: none;
            border-radius: 15px; cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .close-ipk:hover { background: #555; }

        /* --- MODAL --- */
        .jodoh-modal, .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 3000;
            display: flex; align-items: center; justify-content: center; flex-direction: column;
            opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay { z-index: 10000; background: rgba(0,0,0,0.85); backdrop-filter: blur(5px); }
        .jodoh-modal.active, .modal-overlay.active { opacity: 1; visibility: visible; }
        
        .modal-box {
            background: var(--card-bg); padding: 40px; border-radius: 20px;
            text-align: center; max-width: 90%; width: 400px; transform: scale(0.9); transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .modal-overlay.active .modal-box { transform: scale(1); }
        .choice-btn {
            padding: 15px 30px; border: none; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; color: white; margin: 0 10px;
        }
        .btn-if1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-if2 { background: linear-gradient(135deg, #ff9966 0%, #ff5e62 100%); }

        .match-result-box { background: white; padding: 30px; border-radius: 20px; width: 90%; max-width: 350px; text-align: center; overflow: hidden; }
        .match-name { font-size: 24px; font-weight: bold; color: #2c3e50; margin: 15px 0; min-height: 60px; display: flex; align-items: center; justify-content: center;}
        
        .couple-display { display: none; margin-top: 10px; animation: slideUp 0.5s ease; }
        .couple-container { display: flex; flex-direction: column; gap: 10px; align-items: center; justify-content: center; margin-bottom: 10px; }
        .c-name-user { font-size: 18px; font-weight: 700; color: #2c3e50; }
        .c-heart { font-size: 30px; color: #e91e63; animation: heartbeat 1s infinite; }
        .c-name-partner { font-size: 18px; font-weight: 700; color: #e91e63; }
        
        .couple-sub { font-size: 13px; color: #7f8c8d; font-style: italic; margin-top: 5px; line-height: 1.4; padding: 0 5px; }
        .couple-gif { width: 140px; height: auto; border-radius: 10px; margin-top: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .special-title { font-size: 26px; font-weight: 800; color: #c0392b; margin-bottom: 10px; }

        .close-match { margin-top: 20px; background: #333; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;}
        .heart-beat { font-size: 60px; color: #e91e63; animation: heartbeat 1s infinite; margin-bottom: 20px; }
        @keyframes heartbeat { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
        @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Media Query Mobile */
        @media (max-width: 600px) {
            .mobile-layout-controls { display: flex; }
            .grid-container { grid-template-columns: 1fr; padding: 0 10px; }
            .search-box { padding: 0 10px; }
            .pos-left { font-size: 10px; padding: 6px 10px; left: 10px; top: 15px; width: auto; max-width: 150px; }
            .pos-right { font-size: 0; padding: 8px 12px; right: 10px; top: 15px; }
            .pos-right i { margin: 0; font-size: 18px; }
            .pos-theme { right: 75px; width: 35px; height: 35px; font-size: 16px; top: 15px; }
            h1 { font-size: 1.8rem; }
            .grid-container.mobile-grid-active { grid-template-columns: repeat(2, 1fr) !important; gap: 10px; }
            .grid-container.mobile-grid-active .card { padding: 15px 10px; }
            .grid-container.mobile-grid-active .avatar { width: 45px; height: 45px; font-size: 16px; margin-bottom: 8px; }
            .grid-container.mobile-grid-active h3 { font-size: 13px; min-height: 40px; line-height: 1.2; margin-bottom: 5px; }
            .grid-container.mobile-grid-active .nim-badge { font-size: 10px; padding: 3px 8px; }
            .now-playing-box { bottom: 70px; max-width: 250px; }
        }
    </style>
</head>
<body>

<div id="fireflies-container"></div>
<div id="copy-tooltip" class="copy-tooltip">NIM Disalin!</div>

<div id="now-playing-box" class="now-playing-box">
    <div class="np-icon"><i class="fas fa-music"></i></div>
    <div class="np-info">
        <div class="np-label">Now Playing</div>
        <div class="np-title" id="np-title">Judul Lagu</div>
    </div>
    <button class="np-mute" onclick="toggleMute()"><i class="fas fa-volume-up" id="mute-icon"></i></button>
</div>

<div class="modal-overlay" id="selectionModal">
    <div class="modal-box">
        <h2 style="margin-bottom:20px; color:var(--text-color);">Mau Liat Kelas IF Berapa?</h2>
        <div style="display:flex; justify-content:center;">
            <button class="choice-btn btn-if1" onclick="loadClassData('IF1')">IF 1</button>
            <button class="choice-btn btn-if2" onclick="loadClassData('IF2')">IF 2</button>
        </div>
    </div>
</div>

<div class="mobile-layout-controls">
    <button class="mobile-btn active" onclick="setMobileList()" id="btnList"><i class="fas fa-list"></i> List</button>
    <button class="mobile-btn" onclick="setMobileGrid()" id="btnGrid"><i class="fas fa-th-large"></i> Petak</button>
</div>

<div id="main-view">
    <div class="fixed-element pos-left">Karya: Gilang Aidil Pratama</div>
    <button class="fixed-element pos-theme" id="themeToggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
    <a href="http://www.youtube.com/@DilzGhaaziy" target="_blank" class="fixed-element pos-right"><i class="fab fa-youtube"></i><span>Dilz Ghaaziy</span></a>

    <div class="container">
        <header>
            <h1>Daftar Mahasiswa</h1>
            <p class="subtitle"><span id="class-name">Kelas</span> &bull; Cihuyyy</p>
            <div class="search-box">
                <input type="text" id="searchInput" onkeyup="filterNames()" placeholder="Cari nama atau NIM...">
            </div>
        </header>
        <div class="grid-container" id="cardGrid"></div>
    </div>
</div>

<div id="profile-view">
    <div class="galaxy-bg"><div class="stars" id="stars"></div></div>
    <button class="back-btn-float" onclick="closeProfile()"><i class="fas fa-arrow-left"></i> Kembali</button>

    <div class="profile-content">
        <div class="big-profile-card">
            <div class="big-avatar" id="p-avatar">GA</div>
            <h2 id="p-name" style="margin-bottom:5px;">Nama</h2>
            <div id="p-role" class="owner-role" style="display:none;">Pembuat Web</div>
            <div style="display:flex; align-items:center; justify-content:center; margin-bottom:20px;">
                <p id="p-nim" style="color:#ddd; margin:0;">NIM</p>
                <button class="copy-btn" onclick="copyNIM()"><i class="fas fa-copy"></i></button>
            </div>
            <div class="info-row"><span class="info-label">Angkatan</span><span class="info-val">2025</span></div>
            <div class="info-row"><span class="info-label">Kelas</span><span class="info-val" id="p-class">IF X</span></div>
            <div class="info-row"><span class="info-label">Jenis Kelamin</span><span class="info-val" id="p-gender">-</span></div>
            
            <div class="info-row">
                <span class="info-label">Tanggal Lahir</span>
                <span class="info-val">
                    <span id="p-dob">-</span> 
                    <i class="fas fa-edit" title="Edit Tanggal Lahir" style="cursor:pointer; color:#3498db; margin-left:8px; font-size:14px;" onclick="editDOB()"></i>
                </span>
            </div>
            
            <div class="info-row"><span class="info-label">Dosen Pembimbing</span><span class="info-val" id="p-dospem">-</span></div>
            
            <div class="info-row" id="p-status-row" style="display: none;"><span class="info-label">Status Kuliah</span><span class="info-val" id="p-status-val">-</span></div>
            
            <div class="info-row" id="p-ipk-row" style="display: none;"><span class="info-label">IPK</span><span class="info-val" id="p-ipk-val">-</span></div>

            <button class="ipk-btn" onclick="openIPKModal()">
                <i class="fas fa-chart-line"></i> Lihat Detail IPK
            </button> 

            <button class="jodoh-btn" onclick="cekJodoh()">
                <i class="fas fa-heart"></i> Siapa Jodohmu?
            </button>
            <div class="quote-box" id="daily-quote">"Memuat kata-kata..."</div>
        </div>
    </div>
</div>

<div class="ipk-modal" id="ipkModal">
    <div class="ipk-content">
        <div class="ipk-header">
            <h2>Riwayat IPK</h2>
            <p id="ipk-nama-mhs">Nama Mahasiswa</p>
        </div>
        <div class="semester-list" id="semesterList">
            </div>
        <button class="close-ipk" onclick="closeIPKModal()">Tutup</button>
    </div>
</div>

<div class="jodoh-modal" id="jodohModal">
    <div class="heart-beat"><i class="fas fa-heart"></i></div>
    <h2 style="color:white; margin-bottom:20px;">Mencari Koneksi Hati...</h2>
    <div class="match-result-box">
        <div id="searching-ui">
            <div style="font-size:12px; color:#aaa; margin-bottom:10px;">JODOH KAMU ADALAH</div>
            <div class="match-name" id="match-name-display">X</div>
        </div>
        
        <div class="couple-display" id="final-couple-ui"></div>

        <br>
        <button class="close-match" onclick="closeJodoh()">Tutup</button>
    </div>
</div>

<script>
    // --- KONFIGURASI REPO GITHUB (WAJIB DIISI) ---
    // Ganti "USERNAME" dengan username GitHub Anda (contoh: "hendra123")
    // Ganti "REPO" dengan nama repository Anda (contoh: "biodata-if25")
    const REPO_CONFIG = {
        owner: "DilzGhaaziy", 
        name: "IF25-uimDG"        
    };

    // --- DATABASE (DIPERBARUI DENGAN IPK) ---
    const dataIF1 = [
        {name: "Ahmad Afrizal", nim: "5520225011", gender: "L", dob: "20 April 2007", dospem: "Muawan Bisri, S.Kom., M.Kom", role: "Keamanan IF1"},
        {name: "Aisyah Nur Syifa", nim: "5520225021", gender: "P", dob: "27 Maret 2007", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Alfian Febriansyah", nim: "5520225028", gender: "L", dob: "13 Februari 2007", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "Amri Rahman", nim: "5520225005", gender: "L", dob: "27 April 2006", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Azizah Fastabila Putri", nim: "5520225030", gender: "P", dob: "15 November 2006", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "Bahtera Juliandi", nim: "5520225031", gender: "L", dob: "17 Januari 2005", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom.", role: "Keamanan IF1"},
        {name: "Dela Nurcahyani", nim: "5520225003", gender: "P", dob: "15 Desember 2005", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Deri Farhan Syah", nim: "5520225008", gender: "L", dob: "10 November 2006", dospem: "Muawan Bisri, S.Kom., M.Kom", status: "Menghilang Dari Lane"},
        {name: "Dian Parwati", nim: "5520225014", gender: "P", dob: "8 Maret 2006", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        
        // DIKA
        {name: "Dika Afriyogi", nim: "5520225018", gender: "L", dob: "30 September 2005", dospem: "Eko Aziz Apriadi, S.T., M.Kom.", role: "Keamanan IF1", ipk: "3.50", ipk1: "3.50"},
        
        // FIKRI
        {name: "Fikri Julianda Laksono", nim: "5520225009", gender: "L", dob: "21 Juli 2005", dospem: "Muawan Bisri, S.Kom., M.Kom", role: "Ketua IF 1", ipk: "3.80", ipk1: "3.80"},
        
        {name: "Gilang Aidil Pratama", nim: "5520225023", gender: "L", dob: "24 Oktober 2006", dospem: "Eko Aziz Apriadi, S.T., M.Kom.", isOwner: true, status: "Calon Ketua Himatika"},
        {name: "Hafizd Khoirul Azizah", nim: "5520225002", gender: "P", dob: "29 Juli 2006", dospem: "Muawan Bisri, S.Kom., M.Kom", role: "Wakil 1 IF1"},
        {name: "Hanysa Maryani", nim: "5520225006", gender: "P", dob: "20 Maret 2007", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Herliyanda", nim: "5520225020", gender: "L", dob: "26 Juli 2006", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Hilma Sophia Rahmadhani", nim: "5520225032", gender: "P", dob: "30 Agustus 2007", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "I Gede Suparyane", nim: "5520225022", gender: "L", dob: "4 September 2006", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Leni Nuraeni", nim: "5520225026", gender: "P", dob: "28 Juni 2005", dospem: "Eko Aziz Apriadi, S.T., M.Kom.", role: "PJ Matkul"},
        {name: "Lilis Cahya Kurnia", nim: "5520225017", gender: "P", dob: "19 Mei 2007", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Lyla Apriliana", nim: "5520225016", gender: "P", dob: "12 April 2007", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Muhammad Tohir", nim: "5520225004", gender: "L", dob: "10 September 2005", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Muhammad Nirwanda", nim: "5520225012", gender: "L", dob: "5 April 2007", dospem: "Muawan Bisri, S.Kom., M.Kom", role: "PJ Matkul"},
        {name: "Muhammad Ridho", nim: "5520225029", gender: "L", dob: "11 Juni 2006", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "Muhammad Ridho Kurniawan", nim: "5520225024", gender: "L", dob: "99 Galer 2001", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Prio Pambudi", nim: "5520225007", gender: "L", dob: "22 Juli 2006", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Rendi Aditya", nim: "5520225015", gender: "L", dob: "16 Mei 2007", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Rendra Wijaya", nim: "5520225010", gender: "L", dob: "18 Februari 2008", dospem: "Muawan Bisri, S.Kom., M.Kom", role: "Wakil 2 IF1"},
        {name: "Reynaldi Afriyandika", nim: "5520225013", gender: "L", dob: "24 Februari 2008", dospem: "Muawan Bisri, S.Kom., M.Kom"},
        {name: "Sayyid Adil Rosadi", nim: "5520225025", gender: "L", dob: "4 September 2006", dospem: "Eko Aziz Apriadi, S.T., M.Kom."},
        {name: "Zahrosita Fathahunisa", nim: "5520225019", gender: "P", dob: "24 Desemeber 2005", dospem: "Eko Aziz Apriadi, S.T., M.Kom."}
    ];
    
    const dataIF2 = [
        {name: "Ade Ahmad Fahrizal", nim: "5520225043", gender: "L", dob: "Saya Gak Tau", dospem: "Ribut Julianto, S.Kom.,M.T.I."},
        {name: "Ade Rustam Ananta", nim: "5520225055", gender: "L", dob: "19 Januari 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I."},
        {name: "Ayidil Putra Mahkoara", nim: "5520225046", gender: "L", dob: "6 Januari 2006", dospem: "Ribut Julianto, S.Kom.,M.T.I."},
        {name: "Aziz Abdul Jabbar", nim: "5520225064", gender: "L", dob: "2 September 2006", dospem: "Agus Komarudin, S.Kom.,M.T.I."},
        
        // CANTYCA
        {name: "Cantyca Syahrani", nim: "5520225035", gender: "P", dob: "1 Juni 2007", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom.", ipk: "3.67", ipk1: "3.67"},
        
        {name: "Cindy Naura Rafa Ayu", nim: "5520225053", gender: "P", dob: "4 Februari 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I."},
        {name: "Dila Oktaviani", nim: "5520225036", gender: "P", dob: "29 Oktober 2005", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "Febri Diana Fitri", nim: "5520225042", gender: "P", dob: "1 Februari 2006", dospem: "Ribut Julianto, S.Kom.,M.T.I."},
        {name: "Idham Kholid", nim: "5520225052", gender: "L", dob: "30 Juli 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I."},
        {name: "Indria Chika Aprilia", nim: "5520225033", gender: "P", dob: "17 Juli 2007", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom."},
        {name: "Kristia Anggraini", nim: "5520225058", gender: "P", dob: "8 Juli 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I."},
        {name: "Lucky Cahya Khalima Usada", nim: "5520225059", gender: "L", dob: "12 September 2006", dospem: "Agus Komarudin, S.Kom.,M.T.I.", role: "Ketua IF 2"},
        {name: "M. Naufal Zaky Akmal", nim: "5520225045", gender: "L", dob: "15 Januari 2006", dospem: "Ribut Julianto, S.Kom.,M.T.I."},
        {name: "Muhammad Salsabil", nim: "5520225039", gender: "L", dob: "8 Maret 2007", dospem: "Fathoni Dwi Atmoko, S.Kom.,M.Kom.", ipk: ""},
        {name: "Nadina", nim: "5520225063", gender: "P", dob: "12 September 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I.", ipk: "0"},
        {name: "Nana Santiya", nim: "5520225056", gender: "P", dob: "27 September 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I.", ipk: "0"},
        {name: "Reka Sabila", nim: "5520225060", gender: "P", dob: "22 September 2006", dospem: " Agus Komarudin, S.Kom.,M.T.I.", ipk: "0"},
        {name: "Reyhan", nim: "5520225047", gender: "L", dob: "5 Juni 2007", dospem: "Ribut Julianto, S.Kom.,M.T.I.", ipk: "0"},
        {name: "Rizki Agustin Maulana", nim: "5520225061", gender: "L", dob: "14 Mei 2007", dospem: "Agus Komarudin, S.Kom.,M.T.I.", ipk: "0"},
        {name: "Sendi Agustiansyah", nim: "5520225050", gender: "L", dob: "21 September 2005", dospem: "Ribut Julianto, S.Kom.,M.T.I.", ipk: "0"},
        
        // WIDIA
        {name: "Widia Lestari", nim: "5520225040", gender: "P", dob: "23 Mei 2007", dospem: "Ribut Julianto, S.Kom.,M.T.I.", ipk: "3.89", ipk1: "3.89"}
    ];

     const allStudents = [...dataIF1.map(s=>({...s, class:'IF 1'})), ...dataIF2.map(s=>({...s, class:'IF 2'}))];
    const quotes = ["Jadilah versi terbaik.", "Turu jalan ninjaku.", "10% ngetik 90% error.", "Aku belum cebok.", "Jodoh gak kemana.", "Tetap santuy.", "Kita akan mati kapan aja.", "Error 404 katanya.", "Ngoding dulu rawr.", "Cintailah otakmu, jangan ngoding tiap hari.", "Hidup seperti array.(Meme Spongebob)", "PHP tuh bukan pemberi harapan palsu.", "Kuliah Pulang Tidur.", "Uang habis.", "Oh Tuhan, ku sayang dia.", "Bersakit dahulu wisuda kemudian.", "Fokus masa depan.", "Joki hanya di Dilz Ghaaziy JOKI.", "Gak bosen tah ke Be Hots Mulu.", "Kamu udah mandi belum?", "Bahagia itu ketika bisa jajan terus.", "Nilai A buat Kalkulus itu MITOS.", "Masih hidup lu?", "Udah kuliah kok masih labil itu mindset.", "Kucing bawa motor pake helm", "Sayang, kok kamu gak ngabarin aku?", "Bismillah Umroh.", "Lu mah mending, lah gua...", "Jangan panggil aku anak kecil paman!", "Jual tanah demi gaji UMR, What? Total gaji seumur hidup gak sampe harga tanahnya", "Minta doa yang terbaik ke Ibu.", "Fokus, hiyak hiyak hiyak!", "Sebel ga sih nilai C?.", "Tugas kelar.", "Wifi kencang is anugerah.", "Kalo ada cobaan, ya cobain.", "Kalo kata aku, dia gak waras.", "Aku lagi nahan eeq.", "Calon Mahasiswa Cumlaude.", "Ijo Lumut - Ikatan Jomblo Lucu Imut.", "Informatika? Chat GPT!.", "Pergi ke warung beli kopi,(cakep) Ya abis itu pulang.", "Algoritma cinta.", "Ada ide? Chat pribadi ke Owner web ini ya.", "Kayaknya kalo makan mie sukses terus, bisa jadi orang sukses.", "Apa yang kamu harapin dari dia?.", "Aku tak pernah, untuk mencintai...", "Ego vs Ego = Hubungan gak sehat.", "Katamu, pacarmu cuma satu.", "Array of hope.", "Informatika?! Cihuyyyy!.", "Ganteng pendiem = Cool.<br>Jelek pendiem = Introvert", "Duel Game Naruto sama Owner, Menang dapet 100 ribu.", "Bug adalah fitur.", "Ctrl+C Ctrl+V.", "Cihuyyyyy.", "Dibuat makalah minimal 15 lembar ya :).", "Kurang apa nih webnya?.", "Ga suka libur, gak ada jokian.", "Adalah pokoknya.", "Om jangan om", "Tolong jokiin hidupku.", "Searching makna.", "Nyari masalah?", "Recursion.", "Memory leak.", "Garbage collection.", "Compile error.", "Runtime exception.", "Debug hidup.", "Deploy bahagia.", "Version control.", "Git commit.", "Git push.", "Git pull.", "Merge conflict.", "Branch baru.", "Master skills.", "Main function happy.", "Include doa.", "Import sukses.", "Print Hello.", "Return 0.", "Void sedih.", "Public static.", "System out.", "Console log.", "Echo bisa.", "Select rejeki.", "Insert usaha.", "Update skill.", "Delete pikiran.", "Drop malas.", "Create view.", "Grant success.", "Revoke gagal.", "Commit.", "Rollback dosa.", "Savepoint.", "Connect God.", "Disconnect toxic."];

    const coupleVariations = [
        { t: "Ciee, dunia serasa milik berdua nih.", type: "cute" }, { t: "Semoga langgeng sampai wisuda ya!", type: "cute" }, { t: "Aduh gemes banget liatnya.", type: "cute" }, { t: "Cocok banget, kayak kopi sama gula.", type: "cute" }, { t: "Udah jadian aja belum sih?", type: "cute" }, { t: "Kiw kiw cukurukuk ebew rawr well ungrr.", type: "cute" }, { t: "Jangan lupa undang-undang kalau nikah.", type: "cute" }, { t: "Liat kalian berdua bikin iri jomblo.", type: "cute" }, { t: "Chemistry-nya dapet banget!", type: "cute" }, { t: "Kawal sampai halal pokoknya!", type: "cute" }, { t: "Senyumnya mirip, jodoh beneran nih.", type: "cute" }, { t: "Semesta merestui hubungan ini.", type: "cute" }, { t: "Gak usah malu-malu, tembak aja langsung.", type: "cute" }, { t: "Pasangan ter-uwu di angkatan 2025.", type: "cute" }, { t: "Bahagia terus ya kalian berdua.", type: "cute" }, { t: "Kayak ada manis-manisnya gitu.", type: "cute" }, { t: "Fix, tahun depan nyebar undangan.", type: "cute" }, { t: "Cintaku bersemi di ruang C3.", type: "cute" }, { t: "Jangan berantem terus ya, sayang kuotanya.", type: "cute" }, { t: "Semoga jodoh dunia akhirat.", type: "cute" }, { t: "Lucu banget cii kalian.", type: "cute" }, { t: "Tatapan matanya itu lho, dalem banget.", type: "cute" }, { t: "Yang satu ganteng, yang satu cantik. Pas!", type: "cute" }, { t: "Jodoh emang gak kemana, ternyata seprodi.", type: "cute" }, { t: "Semoga kalian selalu bahagia bersama.", type: "cute" },
        { t: "Hadeh, kasian banget jodohnya sama dia.", type: "mock" }, { t: "Yakin mau sama dia? Pikir lagi deh 7x24 jam.", type: "mock" }, { t: "Siap-siap makan ati ya tiap hari.", type: "mock" }, { t: "Jodoh sih, tapi kok kayak terpaksa gitu mukanya?", type: "mock" }, { t: "Awas, dia galak loh kalau lagi laper.", type: "mock" }, { t: "Kuat-kuatin iman ya ngadepin dia.", type: "mock" }, { t: "Yah, nasibmu kurang beruntung dapet dia.", type: "mock" }, { t: "Kok bisa sih jodohnya sama modelan begini?", type: "mock" }, { t: "Sabar ya, ini ujian hidup.", type: "mock" }, { t: "Dompet aman? Dia doyan jajan.", type: "mock" }, { t: "Mending pura-pura gak kenal aja deh.", type: "mock" }, { t: "Selamat menikmati penderitaan.", type: "mock" }, { t: "Dia tidurnya ngorok, yakin mau?", type: "mock" }, { t: "Jodoh sih, tapi boong (canda deng).", type: "mock" }, { t: "Aduh, turun standar banget dapet dia.", type: "mock" }, { t: "Dia suka nahan eeq.", type: "mock" }, { t: "Dia kalau mandi lama banget weee, awas telat ngampus.", type: "mock" }, { t: "Dia kalo bales chat bisa 3 hari, sabar ya.", type: "mock" }, { t: "Hati-hati, dia buaya/kucing garong berkedok mahasiswa.", type: "mock" }, { t: "Yakin mentalmu kuat? Dia drama queen/king.", type: "mock" }, { t: "Duh, sainganmu berat (sama hobi tidurnya).", type: "mock" }, { t: "Pasti kamu banyak dosa makanya dapet dia.", type: "mock" }, { t: "Jangan kaget kalau dia tiba-tiba minjem duit.", type: "mock" }, { t: "Selamat menempuh hidup penuh huru-hara.", type: "mock" }, { t: "Cinta itu buta, makanya kamu mau sama dia.", type: "mock" }
    ];
    const cuteGifs = ["https://media.tenor.com/36d8ovZxZsgAAAAi/bubu-bubu-dudu.gif", "https://media.tenor.com/qQmsOJoeMoMAAAAi/dudu-bubu.gif", "https://media.tenor.com/Eazcnx5O-bgAAAAM/dudu-dudu-cute.gif", "https://media.tenor.com/pN7xf12qQcwAAAAM/cuddle-cute.gif", "https://media.tenor.com/RDwCMZeZ7b8AAAAi/hugs.gif", "https://media.tenor.com/wA5xWw0tNBwAAAAi/h%C3%AAh.gif", "https://media.tenor.com/9Pnoc6MKDrEAAAAi/love-you-too.gif", "https://media.tenor.com/JcPATwwdUOQAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/pdv5YIMB-hkAAAAi/cute.gif", "https://media1.tenor.com/m/z2TX5B4RD34AAAAC/your-so-cute-mini-seb.gif", "https://media1.tenor.com/m/pjBtpAFSnmgAAAAC/peach-goma-peach-and-goma.gif", "https://media1.tenor.com/m/FYrmLKoB1UIAAAAC/peach-and-goma-peach-loves-goma.gif", "https://media.tenor.com/Zrr4L_Wd4JkAAAAi/bubu-rub-bubu-love-dudu.gif", "https://media.tenor.com/vzkveVGDzmAAAAAi/dudu-hug-bubu-dudu-kiss.gif", "https://media1.tenor.com/m/hOmnC-qwGagAAAAC/peach-and-goma.gif", "https://media.tenor.com/KqqtGmNZ_vkAAAAi/bubu-dudu.gif", "https://media.tenor.com/rjnOQXkO-TEAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/wKP-p_HtfOoAAAAi/bubu-dudu.gif", "https://media.tenor.com/cqGxLDiHeKoAAAAi/bubu-dudu-bubu-dudu-love.gif", "https://media.tenor.com/MkU0kjfQnngAAAAi/kiss-bubu.gif", "https://media.tenor.com/vEvRDC60wpoAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/u7fyNJeFi44AAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/fQ0oZELv1y4AAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/UeanLw-I3B4AAAAi/tkthao219-bubududu.gif", "https://media.tenor.com/vJRHkcdlEQQAAAAi/casal-dudu.gif", "https://media.tenor.com/tnTcMaEkXzAAAAAi/tonibear-bubu.gif", "https://media.tenor.com/Zc42xR3zFWYAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/NgAmTbY1aokAAAAi/dare-aggie-dare-aggie-bunny.gif", "https://media.tenor.com/S_lMGnbCMzYAAAAi/bubu-bubu-dudu.gif", "https://media.tenor.com/3BTNvUaCiGgAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/wG7yYjwS7F8AAAAi/milk-and-mocha-sleeping.gif", "https://media1.tenor.com/m/2BrMVhEIsgIAAAAC/mocha-bear-kiss-bear-kiss.gif", "https://media1.tenor.com/m/1gf_Jz8WYH0AAAAC/sami-en-dina-sami-dina.gif", "https://media1.tenor.com/m/WAqsZeIoxnEAAAAC/milk-and-mocha-milk-and-mocha-kiss.gif"];
    const mockGifs = ["https://media.tenor.com/vu0bClH3OiUAAAAM/bubu-dudu-sseeyall.gif", "https://media.tenor.com/8Hs24bl0z94AAAAM/12.gif", "https://media.tenor.com/IFAObJVF4tEAAAAi/bubu-dudu.gif", "https://media.tenor.com/2L3bWLooqT8AAAAi/bubu-silly.gif", "https://media1.tenor.com/m/ddBFqmr_qp0AAAAC/laughing-bubu.gif", "https://media.tenor.com/eSMmyYMJXOcAAAAi/miss-you.gif", "https://media.tenor.com/KmIZbENMqx4AAAAi/bubu-dudu-sseeyall.gif", "https://media1.tenor.com/m/KUGbLzdDd9YAAAAC/bubu-dudu.gif", "https://media.tenor.com/7awxGekCrFoAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/SzjZCjI1kZQAAAAi/bubu-bubu-dudu.gif", "https://media.tenor.com/RhdwDUpRXeMAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/LC74nzQObQ0AAAAi/bubu-dudu.gif", "https://media.tenor.com/tJk6yhct0wMAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/kTIu00Dc0WwAAAAi/hi.gif", "https://media.tenor.com/WZyHt5hOIKsAAAAi/bubu-bubu-dudu.gif", "https://media.tenor.com/wSjhsZknWUsAAAAi/bubu-dudu-sseeyall.gif", "https://media.tenor.com/9gBByPt6k4oAAAAi/bubu-dudu-twitter.gif"];

    let availableVariationIndices = Array.from({length: coupleVariations.length}, (_, i) => i);
    let currentClassData = [], currentClassLabel = "", currentProfile = null;
    let bgmAudio = new Audio();
    let jodohAudio = new Audio(); 
    let currentBgmIndex = -1;
    let currentJodohSongIndex = -1;
    let isMuted = false;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    const bgmPlaylist = [
        {title: "A Thousand Years", url: "https://od.lk/s/NjhfMTYyNzYyNDM2Xw/A%20Thousand%20Years%20%20Shania%20Yan%20Cover.mp3"},
        {title: "Ghost", url: "https://od.lk/s/NjhfMTYyNzYyNDUxXw/Ghost%20-%20Justin%20Bieber%20_%20%23coverbyfaithcns.mp3"},
        {title: "Die With A Smile", url: "https://od.lk/s/NjhfMTYyNzYyNDM8Xw/NGGA%20DULU%20%20Akbar%20Chalay%20feat.%20Ciloqciliq%20_%20Zynakal%20%28Cover%20Akustik%20%20Lirik%20%20Viral%20TikTok%29.mp3"}, 
        {title: "Engga Dulu", url: "https://od.lk/s/NjhfMTYyNzYyNDM8Xw/NGGA%20DULU%20%20Akbar%20Chalay%20feat.%20Ciloqciliq%20_%20Zynakal%20%28Cover%20Akustik%20%20Lirik%20%20Viral%20TikTok%29.mp3"},
        {title: "Night Changes", url: "https://od.lk/s/NjhfMTYyNzYyNDM3Xw/Night%20Changes%20-%20One%20Direction%20%20Shania%20Yan%20Cover.mp3"},
        {title: "Perfect", url: "https://od.lk/s/NjhfMTYyNzYyNDExXw/Perfect%20%20Shania%20Yan%20Cover.mp3"},
        {title: "Rewrite The Stars", url: "https://od.lk/s/NjhfMTYyNzYyNDM9Xw/Rewrite%20The%20Stars%20-%20The%20Greatest%20Showman%20_%20Shania%20Yan%20Cover.mp3"},
        {title: "Angel Baby", url: "https://od.lk/s/NjhfMTYyNzYyNDM9Xw/Troye%20Sivan-Angel%20Baby%20%28cover%29-Studio%20Version%20%20Gigi%20De%20Lana%20%20Jon%20%20Jake%20%20Romeo-Oyus.mp3"}
    ];

    const jodohSongs = [
        "https://od.lk/s/NjhfMTYyNzYyNDI5Xw/Beautiful%20in%20white%20CUT_2_2.mp3",
        "https://od.lk/s/NjhfMTYyNzYyNDMxXw/Rewrite%20the%20start%20CUT.mp3",
        "https://od.lk/s/NjhfMTYyNzYyNDU0Xw/dandelions%20CUT.mp3",
        "https://od.lk/s/NjhfMTYyNzYyNDYwXw/Melukis%20Senja%20CUT.mp3",
        "https://od.lk/s/NjhfMTYyNzYyNDYxXw/Love%20Story%20CUT.mp3"
    ];

    const S_MATI = "https://od.lk/s/NjhfMTYyNzYyNDE7Xw/Ingat%20Mati%20CUT.mp3";
    const S_ISLAMI = "https://od.lk/s/NjhfMTYyNzYyNDE5Xw/Haaaaa%20Islami%20CUT.mp3";
    const S_FUNNY = "https://od.lk/s/NjhfMTYyNzYyNDIwXw/Alur%20Cerita%20FB%20CUT.mp3";
    const S_SAD = "https://od.lk/s/NjhfMTYyNzYyNDE4Xw/Sampai%20kini%20masih%20ku%20coba%20CUT.mp3";
    const S_YALILI = "https://od.lk/s/NjhfMTYyNzYyNDE2Xw/Yalil%20Yalili%20CUT.mp3";
    const CEO_NAMES = ["CEO MBG", "CEO Cendol", "CEO Ayam Potong", "CEO Gorengan", "CEO Ayam Geprek", "CEO Seblak", "CEO EpEp", "CEO Pecel Lele", "CEO Tahu Bulat"];

    window.onload = function() {
        document.getElementById('selectionModal').classList.add('active');
        
        requestAnimationFrame(() => {
            createStars(); 
            createFireflies(); 
        });

        if(localStorage.getItem('theme')==='dark') { document.body.classList.add('dark-mode'); document.querySelector('#themeToggle i').classList.replace('fa-moon','fa-sun'); }
        if(localStorage.getItem('mobileLayout')==='grid') setMobileGrid();
        
        if (window.requestIdleCallback) {
            requestIdleCallback(preloadAudio);
        } else {
            setTimeout(preloadAudio, 3000);
        }
    };

    function preloadAudio() {
        jodohSongs.forEach(url => {
            const tempAudio = new Audio();
            tempAudio.src = url;
            tempAudio.preload = 'none'; 
        });
    }

    // --- BGM PLAYER LOGIC ---
    function playRandomBGM() {
        bgmAudio.pause();
        let newIdx;
        do { newIdx = Math.floor(Math.random() * bgmPlaylist.length); } while (newIdx === currentBgmIndex && bgmPlaylist.length > 1);
        
        currentBgmIndex = newIdx;
        bgmAudio.src = bgmPlaylist[currentBgmIndex].url;
        bgmAudio.volume = 0; 
        bgmAudio.play().then(() => {
            fadeInBGM();
            showNowPlaying(bgmPlaylist[currentBgmIndex].title);
        }).catch(e => console.log("Autoplay blocked"));
        
        bgmAudio.onended = playRandomBGM;
    }

    function fadeInBGM() {
        let vol = 0;
        const fade = setInterval(() => { 
            if(vol < 1.0) { 
                vol += 0.1; 
                if(!isMuted) bgmAudio.volume = Math.min(vol, 1.0); 
            } else { 
                clearInterval(fade); 
            }
        }, 100);
    }

    function showNowPlaying(title) {
        const box = document.getElementById('now-playing-box');
        document.getElementById('np-title').innerText = title;
        box.classList.add('show');
        setTimeout(() => { box.classList.remove('show'); }, 5000); 
    }

    function toggleMute() {
        isMuted = !isMuted;
        bgmAudio.muted = isMuted;
        jodohAudio.muted = isMuted;
        const icon = document.getElementById('mute-icon');
        icon.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
    }

    // --- JODOH PLAYER LOGIC ---
    function playRandomJodohSong() {
        let newIdx;
        do { newIdx = Math.floor(Math.random() * jodohSongs.length); } while (newIdx === currentJodohSongIndex && jodohSongs.length > 1);
        currentJodohSongIndex = newIdx;
        jodohAudio.src = jodohSongs[currentJodohSongIndex];
        jodohAudio.play();
        jodohAudio.onended = playRandomJodohSong; 
    }

    function getStudentCoupleContent() {
        if (availableVariationIndices.length === 0) {
            availableVariationIndices = Array.from({length: coupleVariations.length}, (_, i) => i);
        }
        const randomIndex = Math.floor(Math.random() * availableVariationIndices.length);
        const selectedIndex = availableVariationIndices[randomIndex];
        availableVariationIndices.splice(randomIndex, 1);
        
        const variation = coupleVariations[selectedIndex];
        let gifUrl = variation.type === 'cute' ? cuteGifs[Math.floor(Math.random() * cuteGifs.length)] : mockGifs[Math.floor(Math.random() * mockGifs.length)];
        return { text: variation.t, gif: gifUrl };
    }
    
    // --- UI FUNCTIONS ---
    function playTick() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.type = 'square'; osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.05);
        gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);
        osc.connect(gain); gain.connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime + 0.05);
    }

    function loadClassData(type) {
        const grid = document.getElementById('cardGrid');
        grid.innerHTML = "";
        currentClassData = (type === 'IF1') ? dataIF1 : dataIF2;
        currentClassLabel = (type === 'IF1') ? "IF 1" : "IF 2";
        document.getElementById('class-name').innerText = currentClassLabel;
        
        const fragment = document.createDocumentFragment();

        currentClassData.forEach((s, index) => {
            const card = document.createElement('div'); 
            
            let cardClass = 'card';
            let roleBadge = '';
            
            if (s.isOwner) {
                cardClass += ' owner-card';
                roleBadge = `<div class="owner-badge"><i class="fas fa-crown"></i> Owner</div>`;
            } 
            else if (s.role === "Ketua IF 1" || s.role === "Ketua IF 2") {
                cardClass += ' ketua-card';
                roleBadge = `<div class="ketua-badge"><i class="fas fa-user-tie"></i> ${s.role}</div>`;
            }
            // --- LOGIKA ROLE BARU ---
            else if (s.role === "Wakil 1 IF1") {
                cardClass += ' wakil1-card';
                roleBadge = `<div class="wakil1-badge"><i class="fas fa-star"></i> ${s.role}</div>`;
            }
            else if (s.role === "Wakil 2 IF1") {
                cardClass += ' wakil2-card';
                roleBadge = `<div class="wakil2-badge"><i class="fas fa-star-half-alt"></i> ${s.role}</div>`;
            }
            else if (s.role === "Keamanan IF1") {
                cardClass += ' keamanan-card';
                roleBadge = `<div class="keamanan-badge"><i class="fas fa-shield-alt"></i> ${s.role}</div>`;
            }
            else if (s.role === "PJ Matkul") {
                if (s.name.includes("Leni")) {
                    cardClass += ' pj-leni-card';
                    roleBadge = `<div class="pj-badge pj-leni-badge"><i class="fas fa-book"></i> ${s.role}</div>`;
                } else if (s.name.includes("Nirwanda")) {
                    cardClass += ' pj-nirwanda-card';
                    roleBadge = `<div class="pj-badge pj-nirwanda-badge"><i class="fas fa-book"></i> ${s.role}</div>`;
                }
            }
            
            card.className = cardClass;
            card.dataset.index = index;
            
            card.innerHTML = `${roleBadge}<div class="gender-tag ${s.gender==='L'?'gender-L':'gender-P'}">${s.gender}</div><div class="avatar">${getInitials(s.name)}</div><h3>${s.name}</h3><span class="nim-badge">${s.nim}</span>`;
            fragment.appendChild(card);
        });
        
        grid.appendChild(fragment); 
        document.getElementById('selectionModal').classList.remove('active');
        if(bgmAudio.paused) playRandomBGM();
    }

    // --- EVENT LISTENER UNTUK EFEK GLOW MOUSE ---
    document.getElementById('cardGrid').addEventListener('mousemove', function(e) {
        const card = e.target.closest('.card');
        if (card) {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            card.style.setProperty('--x', `${x}px`);
            card.style.setProperty('--y', `${y}px`);
        }
    });

    document.getElementById('cardGrid').addEventListener('click', function(e) {
        const card = e.target.closest('.card');
        if (card) {
            const index = card.dataset.index;
            if (currentClassData[index]) {
                openProfile(currentClassData[index]);
            }
        }
    });

    function openProfile(s) {
        currentProfile = s;
        if(!isMuted) bgmAudio.volume = 0.2;

        document.getElementById('p-avatar').innerText = getInitials(s.name);
        document.getElementById('p-name').innerText = s.name;
        document.getElementById('p-nim').innerText = s.nim;
        document.getElementById('p-class').innerText = currentClassLabel;
        document.getElementById('p-gender').innerText = s.gender==='L'?'Laki-Laki':'Perempuan';
        document.getElementById('p-dob').innerText = s.dob;
        document.getElementById('p-dospem').innerText = s.dospem;
        
        const statusRow = document.getElementById('p-status-row');
        if(s.status) {
            document.getElementById('p-status-val').innerText = s.status;
            statusRow.style.display = 'flex';
        } else {
            statusRow.style.display = 'none';
        }
        
        // --- LOGIKA IPK ---
        const ipkRow = document.getElementById('p-ipk-row');
        if(s.ipk) {
            document.getElementById('p-ipk-val').innerText = s.ipk;
            ipkRow.style.display = 'flex';
        } else {
            ipkRow.style.display = 'none';
        }

        const profileCard = document.querySelector('.big-profile-card');
        const roleDiv = document.getElementById('p-role');
        
        // Reset kelas profil
        profileCard.className = 'big-profile-card'; 
        roleDiv.className = 'owner-role';
        
        // Reset style manual roleDiv
        roleDiv.style.background = ""; roleDiv.style.color = ""; roleDiv.style.border = "";

        if (s.isOwner) {
            profileCard.classList.add('owner-profile');
            roleDiv.innerText = "Pembuat Web";
            roleDiv.style.display = 'inline-block';
        } else if (s.role) {
            roleDiv.innerText = s.role;
            roleDiv.style.display = 'inline-block';
            
            // --- LOGIKA WARNA PROFIL ---
            if (s.role.includes('Ketua')) {
                profileCard.classList.add('ketua-profile');
                roleDiv.classList.add('ketua-role-tag');
            } else if (s.role === "Wakil 1 IF1") {
                profileCard.classList.add('wakil1-profile');
                roleDiv.style.background = "#fff"; roleDiv.style.color = "#8e44ad";
            } else if (s.role === "Wakil 2 IF1") {
                profileCard.classList.add('wakil2-profile');
                roleDiv.style.background = "#fff"; roleDiv.style.color = "#e67e22";
            } else if (s.role === "Keamanan IF1") {
                profileCard.classList.add('keamanan-profile');
                roleDiv.style.background = "#000"; roleDiv.style.color = "#ff0000"; roleDiv.style.border = "1px solid red";
            } else if (s.role === "PJ Matkul") {
                if(s.name.includes("Leni")) {
                    profileCard.classList.add('pj-leni-profile');
                    roleDiv.style.background = "#ff6f91"; roleDiv.style.color = "#fff";
                } else {
                    profileCard.classList.add('pj-nirwanda-profile');
                    roleDiv.style.background = "#fff"; roleDiv.style.color = "#800020";
                }
            }
        } else {
            roleDiv.style.display = 'none';
        }

        document.getElementById('daily-quote').innerText = `"${quotes[Math.floor(Math.random()*quotes.length)]}"`;
        document.getElementById('main-view').style.opacity = '0';
        setTimeout(() => { document.getElementById('main-view').style.display = 'none'; document.getElementById('profile-view').style.display = 'block'; setTimeout(() => document.getElementById('profile-view').style.opacity = '1', 50); }, 300);
    }

    function closeProfile() {
        if(!isMuted) bgmAudio.volume = 1.0;
        document.getElementById('profile-view').style.opacity = '0';
        setTimeout(() => { document.getElementById('profile-view').style.display = 'none'; document.getElementById('main-view').style.display = 'block'; setTimeout(() => document.getElementById('main-view').style.opacity = '1', 50); }, 300);
    }
    
    // --- FITUR IPK LOGIC (BARU) ---
    function openIPKModal() {
        if (!currentProfile) return;
        
        const modal = document.getElementById('ipkModal');
        const listContainer = document.getElementById('semesterList');
        document.getElementById('ipk-nama-mhs').innerText = currentProfile.name;
        
        listContainer.innerHTML = "";
        
        // Loop Semester 1 sampai 6
        for (let i = 1; i <= 6; i++) {
            let nilai = "0.00";
            let hasScore = false;

            // Logika khusus: Jika semester 1 dan user punya data ipk1
            if (i === 1 && currentProfile.ipk1) {
                nilai = currentProfile.ipk1;
                hasScore = true;
            }

            const row = document.createElement('div');
            row.className = `semester-row ${hasScore ? 'has-score' : ''}`;
            row.innerHTML = `<span>Semester ${i}</span><span>${nilai}</span>`;
            listContainer.appendChild(row);
        }
        
        modal.classList.add('active');
    }

    function closeIPKModal() {
        document.getElementById('ipkModal').classList.remove('active');
    }

    // --- FITUR EDIT DOB REALTIME (Vercel + GitHub) ---
    async function editDOB() {
        if (!currentProfile) return;

        const newDOB = prompt(`Edit Tanggal Lahir untuk ${currentProfile.name}:`, currentProfile.dob);
        
        if (newDOB === null || newDOB.trim() === "" || newDOB === currentProfile.dob) return;

        // Tampilkan loading state
        const dobElement = document.getElementById('p-dob');
        const originalText = dobElement.innerText;
        dobElement.innerHTML = "<em>Menyimpan...</em>";

        try {
            const response = await fetch('/api/update-dob', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    nim: currentProfile.nim,
                    newDOB: newDOB,
                    repoOwner: REPO_CONFIG.owner,
                    repoName: REPO_CONFIG.name
                })
            });

            const result = await response.json();

            if (response.ok) {
                alert("Berhasil disimpan! Data di GitHub akan terupdate.");
                // Update UI Realtime
                dobElement.innerText = newDOB;
                currentProfile.dob = newDOB;
                
                // Update variable lokal agar tidak revert saat modal dibuka tutup tanpa refresh
                const targetData = (currentClassLabel === "IF 1") ? dataIF1 : dataIF2;
                const index = targetData.findIndex(s => s.nim === currentProfile.nim);
                if (index !== -1) targetData[index].dob = newDOB;
            } else {
                throw new Error(result.message || "Gagal menyimpan.");
            }
        } catch (error) {
            alert("Error: " + error.message);
            dobElement.innerText = originalText;
        }
    }

    let matchInterval;
    
    function cekJodoh() {
        if (!currentProfile) return;
        const gender = currentProfile.gender;
        const targetGender = gender === 'L' ? 'P' : 'L'; 
        
        let candidates = allStudents.filter(s => s.gender === targetGender).map(s => ({ type: 'student', ...s }));
        
        candidates.push({ type: 'special', subtype: 'kematian', name: "Kematian" });
        candidates.push({ type: 'special', subtype: 'allah', name: "Hanya Allah Yang Tahu" });
        candidates.push({ type: 'special', subtype: 'ceo', name: "CEO" }); 
        candidates.push({ type: 'special', subtype: 'halu', name: "Dih Ngarepin Siapa Sih, Halu!" });

        if (gender === 'L') {
            candidates.push({ type: 'special', subtype: 'ukthi', name: "Ukthi Yalil Yalili" });
        } else {
            candidates.push({ type: 'special', subtype: 'korea', name: "Cowo Korea" });
            candidates.push({ type: 'special', subtype: 'cina', name: "Cowo Cina" });
        }

        const modal = document.getElementById('jodohModal');
        const searchUI = document.getElementById('searching-ui');
        const finalUI = document.getElementById('final-couple-ui');
        const nameDisplay = document.getElementById('match-name-display');

        searchUI.style.display = 'block';
        finalUI.style.display = 'none';
        modal.classList.add('active');
        if (audioCtx.state === 'suspended') audioCtx.resume();

        matchInterval = setInterval(() => {
            const r = candidates[Math.floor(Math.random() * candidates.length)];
            nameDisplay.innerText = r.name === "CEO" ? CEO_NAMES[Math.floor(Math.random()*CEO_NAMES.length)] : r.name;
            nameDisplay.style.color = "#ccc"; 
            playTick();
        }, 100);

        setTimeout(() => {
            clearInterval(matchInterval);
            let result = candidates[Math.floor(Math.random() * candidates.length)];
            
            searchUI.style.display = 'none';
            finalUI.style.display = 'block';
            finalUI.innerHTML = "";
            
            bgmAudio.pause(); 
            
            let htmlContent = "";

            if (result.type === 'student') {
                const content = getStudentCoupleContent();
                htmlContent = `
                    <div class="couple-container">
                        <div class="c-name-user">${currentProfile.name}</div>
                        <div class="c-heart"><i class="fas fa-heart"></i></div>
                        <div class="c-name-partner">${result.name}</div>
                    </div>
                    <div class="couple-sub">${content.text}</div>
                    <img src="${content.gif}" class="couple-gif" alt="Funny Gif" loading="lazy">
                `;
                playRandomJodohSong(); 
            } else {
                let title = result.name;
                let sub = "";
                let soundToPlay = "";

                switch(result.subtype) {
                    case 'kematian': title = "KEMATIAN"; sub = "Perbaiki Ibadahmu, Kematian Gak Ada Yang Tahu Kapan"; soundToPlay = S_MATI; break;
                    case 'allah': sub = "Sempurnakan, Perbaiki, Dan Pantaskan Agar Allah Berikan Yang Terbaik"; soundToPlay = S_ISLAMI; break;
                    case 'ceo': 
                        title = CEO_NAMES[Math.floor(Math.random() * CEO_NAMES.length)]; sub = "Korban Drachin"; soundToPlay = S_FUNNY; 
                        htmlContent = `<div class="couple-container"><div class="c-name-user">${currentProfile.name}</div><div class="c-heart"><i class="fas fa-heart"></i></div><div class="c-name-partner">${title}</div></div><div class="couple-sub">${sub}</div>`;
                        break;
                    case 'halu': sub = "Dia Udah Jadi Milik Yang Lain :)"; soundToPlay = S_SAD; break;
                    case 'ukthi': sub = "Perbaiki Dirimu Agar Pantas Dengannya Atau Akan Allah Jauhkan"; soundToPlay = S_YALILI; break;
                    case 'korea': case 'cina': sub = "Ah Masa Sih, Emang Dia Mau Ya?"; soundToPlay = S_FUNNY; break;
                }

                if (result.subtype !== 'ceo') {
                    htmlContent = `<div class="special-title">${title}</div><div class="couple-sub">${sub}</div>`;
                }
                
                jodohAudio.src = soundToPlay;
                jodohAudio.play();
                jodohAudio.onended = null; 
            }
            
            finalUI.innerHTML = htmlContent;

        }, 3000);
    }

    function closeJodoh() {
        document.getElementById('jodohModal').classList.remove('active');
        clearInterval(matchInterval);
        jodohAudio.pause(); jodohAudio.currentTime = 0;
        bgmAudio.play();
        if(!isMuted) bgmAudio.volume = 0.2; 
    }

    function copyNIM() { navigator.clipboard.writeText(document.getElementById('p-nim').innerText).then(() => { document.getElementById('copy-tooltip').classList.add('show'); setTimeout(() => document.getElementById('copy-tooltip').classList.remove('show'), 1500); }); }
    function setMobileList() { document.getElementById('cardGrid').classList.remove('mobile-grid-active'); document.getElementById('btnList').classList.add('active'); document.getElementById('btnGrid').classList.remove('active'); localStorage.setItem('mobileLayout', 'list'); }
    function setMobileGrid() { document.getElementById('cardGrid').classList.add('mobile-grid-active'); document.getElementById('btnGrid').classList.add('active'); document.getElementById('btnList').classList.remove('active'); localStorage.setItem('mobileLayout', 'grid'); }
    function toggleTheme() { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode')?'dark':'light'); document.querySelector('#themeToggle i').className = document.body.classList.contains('dark-mode') ? 'fas fa-sun' : 'fas fa-moon'; }
    function getInitials(n) { let p=n.split(" "); return p.length>1?(p[0][0]+p[1][0]).toUpperCase():p[0].substring(0,2).toUpperCase(); }
    
    function createFireflies() { 
        const c=document.getElementById('fireflies-container'); 
        const fragment = document.createDocumentFragment();
        for(let i=0;i<25;i++){ 
            const d=document.createElement('div'); 
            d.className='firefly'; 
            
            const startX = Math.random() * 100;
            const startY = Math.random() * 100;
            d.style.left = startX + 'vw';
            d.style.top = startY + 'vh';
            
            const s=Math.random()*4+4; 
            d.style.width=s+'px'; 
            d.style.height=s+'px'; 
            d.style.animationName = 'drift';
            d.style.animationDuration=`${Math.random()*15+15}s`; 
            d.style.animationDelay=`-${Math.random()*20}s`; 
            d.style.animationIterationCount = 'infinite';
            d.style.animationTimingFunction = 'ease-in-out';
            fragment.appendChild(d); 
        } 
        c.appendChild(fragment);
    }
    
    function createStars() { 
        const s=document.getElementById('stars'); 
        let b=""; 
        for(let i=0;i<150;i++) b+=`${Math.floor(Math.random()*2000)}px ${Math.floor(Math.random()*2000)}px #FFF, `; 
        s.style.boxShadow=b.slice(0,-2); 
    }
    
    let searchTimeout;
    function filterNames() { 
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            const v=document.getElementById("searchInput").value.toUpperCase(); 
            const c=document.getElementById("cardGrid").getElementsByClassName("card"); 
            for(let i=0;i<c.length;i++){ 
                const t=c[i].textContent||c[i].innerText; 
                if(t.toUpperCase().indexOf(v) > -1) {
                    c[i].classList.remove('hidden-card');
                } else {
                    c[i].classList.add('hidden-card');
                }
            } 
        }, 150); 
    }
</script>
</body>
</html>
